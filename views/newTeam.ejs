<!DOCTYPE html>
<html>
  <%- include('./header'); -%>
  <%- include('./navs'); -%>
  <%_ if (!user) { -%>
<div class="card m-3">
  <div class="card-header bg-secondary text-light">Please Sign In</div>
    <form id="login">
      <h6>Username</h6>
      <input type="text" name="_id" class="ml-4">
      <button type="submit" class="btn btn-info btn-block">Sign in</button>
    </form>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script> // Log in
    $('#login').on('submit', function(event) {
      const form = $(this);
      event.preventDefault();
      console.log("test");
      $.ajax({method: 'post', url: '/login', data: form.serialize()})
        .done(() => window.location.reload())
        .fail(error => alert('Could not log in.'));
    })
  </script>
  <%_ } else { -%>
    <head> <a href="/logout">Logout</a> </head>
    <p>Hello, <%= user._id -%>!</p>
    <h2>Team Management</h2>
    <div class="card">
      <div class="card-body">
        <h5 class="card-title">Create A New Team</h5>
        <p class="card-text">Want to join the league? Awesome! Get started by entering your team name below</p>
        <input type="text" class="pr-3" id="teamName" name="id" value="">
        <button id="create" class="btn btn-primary ml-2">Create Your Team</button>
      </div>
    </div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous">
    </script>
    <script>
      $('.active').removeClass('active');
      $('#newTeam').addClass('active');

      $('#create').on('click', function(event){
        event.preventDefault();
        const form = $('#teamName');
        const teamName = form.serialize();
        $('#teamName').val('');
        $.ajax({method: 'post', url: '/teams/new', data: `${teamName}&score=0`})
          .done(response.render('/viewTeam'))
          .fail(console.log(error.responseText));
      });

    </script>
</html>
